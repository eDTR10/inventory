import{c as R,r as c,j as e,a as q,X as Q,B as b,i as F,u as z}from"./index-3ecb7c7f.js";import{g as D,a as A,b as M,c as L,u as U,i as $,d as B,e as G,f as P,h as O}from"./inventoryCrud-1f4d2d1c.js";const H=R("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Y=R("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),J=()=>{const[l,o]=c.useState([]),[d,m]=c.useState(!1),[x,s]=c.useState(null),i=c.useCallback(async()=>{m(!0),s(null);try{const t=await D();return o(t),t}catch(t){const a=t instanceof Error?t.message:"Failed to fetch items";throw s(a),t}finally{m(!1)}},[]),N=c.useCallback(async t=>{s(null);try{return await A(t)}catch(a){const r=a instanceof Error?a.message:"Failed to get item";throw s(r),a}},[]),f=c.useCallback(async t=>{s(null);try{return await M(t),await i(),t}catch(a){const r=a instanceof Error?a.message:"Failed to add item";throw s(r),a}},[i]),u=c.useCallback(async t=>{s(null);try{await L(t),await i()}catch(a){const r=a instanceof Error?a.message:"Failed to add items";throw s(r),a}},[i]),g=c.useCallback(async(t,a)=>{s(null);try{await U(t,a),await i()}catch(r){const p=r instanceof Error?r.message:"Failed to update item";throw s(p),r}},[i]),j=c.useCallback(async(t,a=1)=>{s(null);try{await $(t,a),await i()}catch(r){const p=r instanceof Error?r.message:"Failed to increase quantity";throw s(p),r}},[i]),y=c.useCallback(async(t,a=1)=>{s(null);try{await B(t,a),await i()}catch(r){const p=r instanceof Error?r.message:"Failed to decrease quantity";throw s(p),r}},[i]),w=c.useCallback(async t=>{s(null);try{await G(t),await i()}catch(a){const r=a instanceof Error?a.message:"Failed to delete item";throw s(r),a}},[i]),v=c.useCallback(async()=>{s(null);try{await P(),o([])}catch(t){const a=t instanceof Error?t.message:"Failed to clear inventory";throw s(a),t}},[]),k=c.useCallback(async()=>{s(null);try{await O()}catch(t){const a=t instanceof Error?t.message:"Failed to initialize sheet";throw s(a),t}},[]);return{items:l,loading:d,error:x,fetchItems:i,getItem:N,addItem:f,addItems:u,updateItem:g,addQuantity:j,removeQuantity:y,deleteItem:w,clearAll:v,initSheet:k}},C=c.forwardRef(({className:l,type:o,...d},m)=>e.jsx("input",{type:o,className:q("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:m,...d}));C.displayName="Input";const T=l=>JSON.stringify({itemName:l}),V=(l,o=200)=>{const d=T(l),m=encodeURIComponent(d);return`https://api.qrserver.com/v1/create-qr-code/?size=${o}x${o}&data=${m}`},X=({itemName:l,onClose:o})=>{const[d,m]=c.useState(300),x=V(l,d),s=async()=>{try{const N=await(await fetch(x)).blob(),f=window.URL.createObjectURL(N),u=document.createElement("a");u.href=f,u.download=`${l}-qrcode.png`,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(f),document.body.removeChild(u)}catch(i){console.error("Failed to download QR code:",i)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"QR Code"}),o&&e.jsx("button",{onClick:o,className:"p-1 hover:bg-gray-100 dark:hover:bg-slate-800 rounded",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Item: ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:l})]}),e.jsx("div",{className:"bg-white p-4 rounded border border-gray-200 flex items-center justify-center mb-4",children:e.jsx("img",{src:x,alt:`QR Code for ${l}`,className:"w-full"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Size (px)"}),e.jsx("input",{type:"range",min:"150",max:"500",step:"50",value:d,onChange:i=>m(parseInt(i.target.value)),className:"w-full"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[d,"x",d,"px"]})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-slate-800 p-3 rounded mb-4",children:"ðŸ“± Scan this QR code to quickly adjust inventory quantities. Perfect for warehouse operations!"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:s,className:"flex-1",variant:"default",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Download"]}),o&&e.jsx(b,{onClick:o,variant:"outline",className:"flex-1",children:"Close"})]})]})})},_=()=>{const{items:l,loading:o,error:d,fetchItems:m,addItem:x,updateItem:s,deleteItem:i,addQuantity:N,removeQuantity:f,initSheet:u}=J(),[g,j]=c.useState({itemName:"",image:"",quantity:0}),[y,w]=c.useState(null),[v,k]=c.useState(null);c.useEffect(()=>{(async()=>{try{await u(),await m()}catch(h){console.error("Failed to initialize:",h)}})()},[]);const t=n=>{const{name:h,value:I}=n.target;j(S=>({...S,[h]:h==="quantity"?parseInt(I)||0:I}))},a=async n=>{if(n.preventDefault(),!g.itemName.trim()){alert("Please enter an item name");return}try{y?(await s(y,g),w(null)):await x(g),j({itemName:"",image:"",quantity:0})}catch(h){console.error("Failed to save item:",h)}},r=n=>{j({itemName:n.itemName,image:n.image||"",quantity:n.quantity}),w(n.itemName)},p=async n=>{if(window.confirm(`Delete "${n}"?`))try{await i(n)}catch(h){console.error("Failed to delete item:",h)}},E=async(n,h)=>{try{h==="add"?await N(n,1):await f(n,1)}catch(I){console.error("Failed to change quantity:",I)}};return e.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Inventory Management"}),d&&e.jsxs("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded",children:["Error: ",d]}),e.jsxs("form",{onSubmit:a,className:"mb-8 p-6 bg-gray-50 rounded-lg border",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:y?"Edit Item":"Add New Item"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Item Name *"}),e.jsx(C,{type:"text",name:"itemName",value:g.itemName,onChange:t,placeholder:"e.g., Sack Bag",disabled:!!y})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Image URL"}),e.jsx(C,{type:"text",name:"image",value:g.image,onChange:t,placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quantity"}),e.jsx(C,{type:"number",name:"quantity",value:g.quantity,onChange:t,placeholder:"0"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{type:"submit",children:y?"Update Item":"Add Item"}),y&&e.jsx(b,{type:"button",variant:"outline",onClick:()=>{w(null),j({itemName:"",image:"",quantity:0})},children:"Cancel"})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Inventory Items (",l.length,")"]}),o?e.jsx("p",{className:"text-gray-600",children:"Loading items..."}):l.length===0?e.jsx("p",{className:"text-gray-600",children:"No items in inventory"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border p-3 text-left",children:"Item Name"}),e.jsx("th",{className:"border p-3 text-left",children:"Image"}),e.jsx("th",{className:"border p-3 text-right",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-center",children:"QR Code"}),e.jsx("th",{className:"border p-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(n=>e.jsxs("tr",{className:"border hover:bg-gray-50",children:[e.jsx("td",{className:"border p-3 font-medium",children:n.itemName}),e.jsx("td",{className:"border p-3",children:n.image?e.jsx("a",{href:n.image,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"View Image"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"border p-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>E(n.itemName,"remove"),className:"px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200",children:"-"}),e.jsx("span",{className:"w-8 text-center font-semibold",children:n.quantity}),e.jsx("button",{onClick:()=>E(n.itemName,"add"),className:"px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200",children:"+"})]})}),e.jsx("td",{className:"border p-3 text-center",children:e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>k(n.itemName),className:"gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Show QR"]})}),e.jsx("td",{className:"border p-3 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>r(n),children:"Edit"}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>p(n.itemName),className:"text-red-600 hover:text-red-700",children:"Delete"})]})})]},n.id))})]})})]}),v&&e.jsx(X,{itemName:v,onClose:()=>k(null)})]})},K=({children:l,onLogin:o})=>F()?e.jsx(e.Fragment,{children:l}):e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-background to-background/80",children:e.jsxs("div",{className:"text-center space-y-6 p-8 max-w-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Access Required"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"You need to authenticate with Google to access the inventory system."})]}),e.jsxs("div",{className:"bg-muted p-6 rounded-lg space-y-3 text-sm",children:[e.jsx("p",{className:"text-left",children:e.jsx("span",{className:"font-semibold",children:"Benefits:"})}),e.jsxs("ul",{className:"text-left space-y-2",children:[e.jsx("li",{children:"âœ“ Secure access to your inventory data"}),e.jsx("li",{children:"âœ“ Real-time synchronization with Google Sheets"}),e.jsx("li",{children:"âœ“ Full CRUD operations"}),e.jsx("li",{children:"âœ“ Automatic data backup"})]})]}),e.jsx(b,{onClick:o,size:"lg",className:"w-full",children:"Sign In with Google"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded text-xs text-left",children:e.jsxs("p",{className:"text-blue-900 dark:text-blue-100",children:[e.jsx("span",{className:"font-semibold",children:"ðŸ’¡ Tip:"})," Check your browser console (F12) for detailed login information."]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your data is secure and we only access what you allow."})]})}),ee=()=>{const{login:l}=z(),[o,d]=c.useState(null),m=async()=>{d(null);try{await l()}catch(x){const s=x instanceof Error?x.message:"Failed to login";d(s)}};return e.jsxs("div",{className:" min-h-full w-full max-w-[1468px]  flex flex-col justify-center",children:[e.jsx(K,{onLogin:m,children:e.jsx(_,{})}),o&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 text-red-700 rounded",children:e.jsxs("p",{children:["Error: ",o]})})]})};export{ee as default};
