import{c as R,r as p,j as e,X as Q,B as o,i as S,u as U}from"./index-0b92f6de.js";import{u as E,I as C}from"./input-17fac38a.js";const z=R("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),D=R("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),M=R("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),A=a=>`${window.location.origin}/inventory/item/${encodeURIComponent(a)}`,F=(a,s=200)=>{const n=A(a),m=encodeURIComponent(n);return`https://api.qrserver.com/v1/create-qr-code/?size=${s}x${s}&data=${m}&margin=15`},$=({itemName:a,onClose:s})=>{const[n,m]=p.useState(300),x=F(a,n),u=`https://edtr10.github.io//inventory/item/${encodeURIComponent(a)}`,w=async()=>{try{const I=await(await fetch(x)).blob(),l=new Image;l.onload=()=>{const d=document.createElement("canvas"),r=30,j=60,b=l.width+r*2,y=l.height+r*2+j,i=d.getContext("2d");i&&(d.width=b,d.height=y,i.fillStyle="white",i.fillRect(0,0,b,y),i.drawImage(l,r,r),i.fillStyle="#1f2937",i.font="bold 20px Arial, sans-serif",i.textAlign="center",i.fillText(`${a}`,b/2,l.height+r+45),d.toBlob(f=>{if(f){const N=window.URL.createObjectURL(f),h=document.createElement("a");h.href=N,h.download=`${a}-qrcode.png`,document.body.appendChild(h),h.click(),window.URL.revokeObjectURL(N),document.body.removeChild(h)}}))},l.src=URL.createObjectURL(I)}catch(g){console.error("Failed to download QR code:",g)}},k=()=>{window.open(u,"_blank")};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"QR Code Link"}),s&&e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 dark:hover:bg-slate-800 rounded",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Item: ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a})]}),e.jsx("div",{className:"bg-white p-4 rounded border border-gray-200 flex items-center justify-center mb-4",children:e.jsx("img",{src:x,alt:`QR Code for ${a}`,className:"w-full"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Size (px)"}),e.jsx("input",{type:"range",min:"150",max:"500",step:"50",value:n,onChange:g=>m(parseInt(g.target.value)),className:"w-full"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[n,"x",n,"px"]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-slate-800 rounded border border-blue-200 dark:border-blue-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white mb-2",children:"Link:"}),e.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 break-all font-mono",children:u})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-slate-800 p-3 rounded mb-4",children:"ðŸ“± Scan this QR code to open the item page where users can add or deduct quantities from their mobile device!"})]}),e.jsxs("div",{className:"flex gap-2 flex-col",children:[e.jsxs(o,{onClick:w,className:"w-full",variant:"default",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Download QR Code"]}),e.jsxs(o,{onClick:k,variant:"outline",className:"w-full",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Open Item Link"]}),s&&e.jsx(o,{onClick:s,variant:"outline",className:"w-full",children:"Close"})]})]})})},H=()=>{const{items:a,loading:s,error:n,fetchItems:m,addItem:x,updateItem:u,deleteItem:w,addQuantity:k,removeQuantity:g,initSheet:I}=E(),[l,d]=p.useState({itemName:"",image:"",quantity:0}),[r,j]=p.useState(null),[b,y]=p.useState(null);p.useEffect(()=>{(async()=>{try{await I(),await m()}catch(c){console.error("Failed to initialize:",c)}})()},[]);const i=t=>{const{name:c,value:v}=t.target;d(L=>({...L,[c]:c==="quantity"?parseInt(v)||0:v}))},f=async t=>{if(t.preventDefault(),!l.itemName.trim()){alert("Please enter an item name");return}try{r?(await u(r,l),j(null)):await x(l),d({itemName:"",image:"",quantity:0})}catch(c){console.error("Failed to save item:",c)}},N=t=>{d({itemName:t.itemName,image:t.image||"",quantity:t.quantity}),j(t.itemName)},h=async t=>{if(window.confirm(`Delete "${t}"?`))try{await w(t)}catch(c){console.error("Failed to delete item:",c)}},q=async(t,c)=>{try{c==="add"?await k(t,1):await g(t,1)}catch(v){console.error("Failed to change quantity:",v)}};return e.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Inventory Management"}),n&&e.jsxs("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded",children:["Error: ",n]}),e.jsxs("form",{onSubmit:f,className:"mb-8 p-6 bg-gray-50 rounded-lg border",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:r?"Edit Item":"Add New Item"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Item Name *"}),e.jsx(C,{type:"text",name:"itemName",value:l.itemName,onChange:i,placeholder:"e.g., Sack Bag",disabled:!!r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Image URL"}),e.jsx(C,{type:"text",name:"image",value:l.image,onChange:i,placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quantity"}),e.jsx(C,{type:"number",name:"quantity",value:l.quantity,onChange:i,placeholder:"0"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{type:"submit",children:r?"Update Item":"Add Item"}),r&&e.jsx(o,{type:"button",variant:"outline",onClick:()=>{j(null),d({itemName:"",image:"",quantity:0})},children:"Cancel"})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Inventory Items (",a.length,")"]}),s?e.jsx("p",{className:"text-gray-600",children:"Loading items..."}):a.length===0?e.jsx("p",{className:"text-gray-600",children:"No items in inventory"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border p-3 text-left",children:"Item Name"}),e.jsx("th",{className:"border p-3 text-left",children:"Image"}),e.jsx("th",{className:"border p-3 text-right",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-center",children:"QR Code"}),e.jsx("th",{className:"border p-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:a.map(t=>e.jsxs("tr",{className:"border hover:bg-gray-50",children:[e.jsx("td",{className:"border p-3 font-medium",children:t.itemName}),e.jsx("td",{className:"border p-3",children:t.image?e.jsx("a",{href:t.image,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"View Image"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"border p-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>q(t.itemName,"remove"),className:"px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200",children:"-"}),e.jsx("span",{className:"w-8 text-center font-semibold",children:t.quantity}),e.jsx("button",{onClick:()=>q(t.itemName,"add"),className:"px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200",children:"+"})]})}),e.jsx("td",{className:"border p-3 text-center",children:e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>y(t.itemName),className:"gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Show QR"]})}),e.jsx("td",{className:"border p-3 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>N(t),children:"Edit"}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>h(t.itemName),className:"text-red-600 hover:text-red-700",children:"Delete"})]})})]},t.id))})]})})]}),b&&e.jsx($,{itemName:b,onClose:()=>y(null)})]})},O=({children:a,onLogin:s})=>S()?e.jsx(e.Fragment,{children:a}):e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-background to-background/80",children:e.jsxs("div",{className:"text-center space-y-6 p-8 max-w-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Access Required"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"You need to authenticate with Google to access the inventory system."})]}),e.jsxs("div",{className:"bg-muted p-6 rounded-lg space-y-3 text-sm",children:[e.jsx("p",{className:"text-left",children:e.jsx("span",{className:"font-semibold",children:"Benefits:"})}),e.jsxs("ul",{className:"text-left space-y-2",children:[e.jsx("li",{children:"âœ“ Secure access to your inventory data"}),e.jsx("li",{children:"âœ“ Real-time synchronization with Google Sheets"}),e.jsx("li",{children:"âœ“ Full CRUD operations"}),e.jsx("li",{children:"âœ“ Automatic data backup"})]})]}),e.jsx(o,{onClick:s,size:"lg",className:"w-full",children:"Sign In with Google"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded text-xs text-left",children:e.jsxs("p",{className:"text-blue-900 dark:text-blue-100",children:[e.jsx("span",{className:"font-semibold",children:"ðŸ’¡ Tip:"})," Check your browser console (F12) for detailed login information."]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your data is secure and we only access what you allow."})]})}),P=()=>{const{login:a}=U(),[s,n]=p.useState(null),m=async()=>{n(null);try{await a()}catch(x){const u=x instanceof Error?x.message:"Failed to login";n(u)}};return e.jsxs("div",{className:" min-h-full w-full max-w-[1468px]  flex flex-col justify-center",children:[e.jsx(O,{onLogin:m,children:e.jsx(H,{})}),s&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 text-red-700 rounded",children:e.jsxs("p",{children:["Error: ",s]})})]})};export{P as default};
