import{c as v,r as u,j as e,X as L,B as c,i as S,u as z}from"./index-52d95fd0.js";import{u as E,I as f}from"./input-c0c4aa02.js";const U=v("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),D=v("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),M=v("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),F=a=>`${window.location.origin}/inventory/item/${encodeURIComponent(a)}`,A=(a,s=200)=>{const n=F(a),d=encodeURIComponent(n);return`https://api.qrserver.com/v1/create-qr-code/?size=${s}x${s}&data=${d}&margin=15`},$=({itemName:a,onClose:s})=>{const[n,d]=u.useState(300),o=A(a,n),m=`https://edtr10.github.io//inventory/item/${encodeURIComponent(a)}`,b=async()=>{try{const j=await(await fetch(o)).blob(),i=window.URL.createObjectURL(j),l=document.createElement("a");l.href=i,l.download=`${a}-qrcode.png`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(i),document.body.removeChild(l)}catch(x){console.error("Failed to download QR code:",x)}},p=()=>{window.open(m,"_blank")};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"QR Code Link"}),s&&e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 dark:hover:bg-slate-800 rounded",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Item: ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a})]}),e.jsx("div",{className:"bg-white p-4 rounded border border-gray-200 flex items-center justify-center mb-4",children:e.jsx("img",{src:o,alt:`QR Code for ${a}`,className:"w-full"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Size (px)"}),e.jsx("input",{type:"range",min:"150",max:"500",step:"50",value:n,onChange:x=>d(parseInt(x.target.value)),className:"w-full"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[n,"x",n,"px"]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-slate-800 rounded border border-blue-200 dark:border-blue-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white mb-2",children:"Link:"}),e.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 break-all font-mono",children:m})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-slate-800 p-3 rounded mb-4",children:"ðŸ“± Scan this QR code to open the item page where users can add or deduct quantities from their mobile device!"})]}),e.jsxs("div",{className:"flex gap-2 flex-col",children:[e.jsxs(c,{onClick:b,className:"w-full",variant:"default",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Download QR Code"]}),e.jsxs(c,{onClick:p,variant:"outline",className:"w-full",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Open Item Link"]}),s&&e.jsx(c,{onClick:s,variant:"outline",className:"w-full",children:"Close"})]})]})})},B=()=>{const{items:a,loading:s,error:n,fetchItems:d,addItem:o,updateItem:m,deleteItem:b,addQuantity:p,removeQuantity:x,initSheet:j}=E(),[i,l]=u.useState({itemName:"",image:"",quantity:0}),[h,y]=u.useState(null),[w,k]=u.useState(null);u.useEffect(()=>{(async()=>{try{await j(),await d()}catch(r){console.error("Failed to initialize:",r)}})()},[]);const N=t=>{const{name:r,value:g}=t.target;l(Q=>({...Q,[r]:r==="quantity"?parseInt(g)||0:g}))},C=async t=>{if(t.preventDefault(),!i.itemName.trim()){alert("Please enter an item name");return}try{h?(await m(h,i),y(null)):await o(i),l({itemName:"",image:"",quantity:0})}catch(r){console.error("Failed to save item:",r)}},R=t=>{l({itemName:t.itemName,image:t.image||"",quantity:t.quantity}),y(t.itemName)},q=async t=>{if(window.confirm(`Delete "${t}"?`))try{await b(t)}catch(r){console.error("Failed to delete item:",r)}},I=async(t,r)=>{try{r==="add"?await p(t,1):await x(t,1)}catch(g){console.error("Failed to change quantity:",g)}};return e.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Inventory Management"}),n&&e.jsxs("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded",children:["Error: ",n]}),e.jsxs("form",{onSubmit:C,className:"mb-8 p-6 bg-gray-50 rounded-lg border",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:h?"Edit Item":"Add New Item"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Item Name *"}),e.jsx(f,{type:"text",name:"itemName",value:i.itemName,onChange:N,placeholder:"e.g., Sack Bag",disabled:!!h})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Image URL"}),e.jsx(f,{type:"text",name:"image",value:i.image,onChange:N,placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quantity"}),e.jsx(f,{type:"number",name:"quantity",value:i.quantity,onChange:N,placeholder:"0"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"submit",children:h?"Update Item":"Add Item"}),h&&e.jsx(c,{type:"button",variant:"outline",onClick:()=>{y(null),l({itemName:"",image:"",quantity:0})},children:"Cancel"})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Inventory Items (",a.length,")"]}),s?e.jsx("p",{className:"text-gray-600",children:"Loading items..."}):a.length===0?e.jsx("p",{className:"text-gray-600",children:"No items in inventory"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border p-3 text-left",children:"Item Name"}),e.jsx("th",{className:"border p-3 text-left",children:"Image"}),e.jsx("th",{className:"border p-3 text-right",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-center",children:"QR Code"}),e.jsx("th",{className:"border p-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:a.map(t=>e.jsxs("tr",{className:"border hover:bg-gray-50",children:[e.jsx("td",{className:"border p-3 font-medium",children:t.itemName}),e.jsx("td",{className:"border p-3",children:t.image?e.jsx("a",{href:t.image,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"View Image"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"border p-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>I(t.itemName,"remove"),className:"px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200",children:"-"}),e.jsx("span",{className:"w-8 text-center font-semibold",children:t.quantity}),e.jsx("button",{onClick:()=>I(t.itemName,"add"),className:"px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200",children:"+"})]})}),e.jsx("td",{className:"border p-3 text-center",children:e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>k(t.itemName),className:"gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Show QR"]})}),e.jsx("td",{className:"border p-3 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(c,{size:"sm",variant:"outline",onClick:()=>R(t),children:"Edit"}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>q(t.itemName),className:"text-red-600 hover:text-red-700",children:"Delete"})]})})]},t.id))})]})})]}),w&&e.jsx($,{itemName:w,onClose:()=>k(null)})]})},G=({children:a,onLogin:s})=>S()?e.jsx(e.Fragment,{children:a}):e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-background to-background/80",children:e.jsxs("div",{className:"text-center space-y-6 p-8 max-w-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Access Required"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"You need to authenticate with Google to access the inventory system."})]}),e.jsxs("div",{className:"bg-muted p-6 rounded-lg space-y-3 text-sm",children:[e.jsx("p",{className:"text-left",children:e.jsx("span",{className:"font-semibold",children:"Benefits:"})}),e.jsxs("ul",{className:"text-left space-y-2",children:[e.jsx("li",{children:"âœ“ Secure access to your inventory data"}),e.jsx("li",{children:"âœ“ Real-time synchronization with Google Sheets"}),e.jsx("li",{children:"âœ“ Full CRUD operations"}),e.jsx("li",{children:"âœ“ Automatic data backup"})]})]}),e.jsx(c,{onClick:s,size:"lg",className:"w-full",children:"Sign In with Google"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded text-xs text-left",children:e.jsxs("p",{className:"text-blue-900 dark:text-blue-100",children:[e.jsx("span",{className:"font-semibold",children:"ðŸ’¡ Tip:"})," Check your browser console (F12) for detailed login information."]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your data is secure and we only access what you allow."})]})}),P=()=>{const{login:a}=z(),[s,n]=u.useState(null),d=async()=>{n(null);try{await a()}catch(o){const m=o instanceof Error?o.message:"Failed to login";n(m)}};return e.jsxs("div",{className:" min-h-full w-full max-w-[1468px]  flex flex-col justify-center",children:[e.jsx(G,{onLogin:d,children:e.jsx(B,{})}),s&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 text-red-700 rounded",children:e.jsxs("p",{children:["Error: ",s]})})]})};export{P as default};
