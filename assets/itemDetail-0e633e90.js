import{c as o,a as S,b as P,u as Q,r,j as e,B as u}from"./index-9cad157e.js";import{u as D,I as E}from"./input-decec21a.js";import{L as B}from"./LoginScreen-344ba633.js";import{C as v}from"./chevron-left-9aa5a57a.js";const g=o("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),$=o("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),N=o("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),U=o("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),T=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),K=()=>{const{itemName:c}=S(),p=P(),{isAuthenticated:w,isLoading:k}=Q(),{items:h,loading:C,error:f,initSheet:I,fetchItems:A,addQuantity:M,removeQuantity:q}=D(),[s,L]=r.useState(null),[t,d]=r.useState(1),[m,i]=r.useState(null),[R,y]=r.useState(!0),[n,x]=r.useState(!1),j=r.useRef(!1),l=r.useRef(!1);r.useEffect(()=>{if(j.current)return;j.current=!0,(async()=>{try{y(!0),await I(),await A()}catch(b){console.error("Failed to initialize:",b)}finally{y(!1)}})()},[]),r.useEffect(()=>{if(c&&h.length>0){const a=h.find(b=>b.itemName.toLowerCase()===decodeURIComponent(c).toLowerCase());a&&L(a)}},[c,h]);const F=async()=>{if(!(n||l.current)){if(!s||t<=0){i({type:"error",message:"Please enter a valid quantity"});return}try{l.current=!0,x(!0),await M(s.itemName,t),i({type:"success",message:`Added ${t} to inventory!`}),d(1)}catch(a){i({type:"error",message:"Failed to update quantity"}),console.error("Failed to add quantity:",a)}finally{x(!1),l.current=!1}}},z=async()=>{if(!(n||l.current)){if(!s||t<=0){i({type:"error",message:"Please enter a valid quantity"});return}try{l.current=!0,x(!0),await q(s.itemName,t),i({type:"success",message:`Removed ${t} from inventory!`}),d(1)}catch(a){i({type:"error",message:"Failed to update quantity"}),console.error("Failed to remove quantity:",a)}finally{x(!1),l.current=!1}}};return k?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-white to-blue-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-8",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-blue-600 border-r-blue-400 animate-spin"}),e.jsx("div",{className:"absolute inset-2 rounded-full border-4 border-transparent border-b-blue-500 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded-full animate-pulse"})})]}),e.jsx("p",{className:"text-lg text-gray-700 font-bold",children:"Checking authentication..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please wait"})]})}):w?C||R?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br ",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-8",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-blue-600 border-r-blue-400 animate-spin"}),e.jsx("div",{className:"absolute inset-2 rounded-full border-4 border-transparent border-b-blue-500 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded-full animate-pulse"})})]}),e.jsx("p",{className:"text-lg text-gray-700 font-bold",children:"Loading item details..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please wait"})]})}):s?e.jsxs("div",{className:"min-h-screen  mt-6 sm:mt-4 p-4 pt-0 pb-8 relative overflow-hidden",children:[e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-blue-100/30 rounded-full blur-3xl -mr-48 -mt-48"})}),e.jsxs("div",{className:"max-w-2xl mx-auto relative z-10",children:[e.jsx("div",{className:"mb-8 fixed z-50 left-10 top-6",children:e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>p("/inventory/view"),className:"gap-2 border-blue-200 bg-white hover:bg-blue-50 text-blue-600 transition-all",children:[e.jsx(v,{className:"w-4 h-4"}),"Back"]})}),e.jsxs("div",{className:"bg-white rounded-2xl sm:mt-3 shadow-md overflow-hidden border border-blue-100 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"relative w-full h-48 sm:h-48 bg-blue-50 overflow-hidden border-b border-blue-100",children:s.image?e.jsx("img",{src:s.image,alt:s.itemName,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-blue-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl sm:text-6xl mb-2",children:"ðŸ“¦"}),e.jsx("span",{className:"text-blue-400 text-sm sm:text-lg font-medium",children:"No Image Available"})]})})}),e.jsxs("div",{className:"p-4 sm:p-4",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-gray-900 mb-1",children:s.itemName}),e.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-6 sm:mb-8",children:"Inventory Management"}),e.jsxs("div",{className:"mb-6 sm:mb-8 p-4 sm:p-6 bg-blue-50 rounded-xl border border-blue-200",children:[e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-blue-600 uppercase tracking-wide mb-2",children:"Current Stock"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"text-3xl sm:text-5xl font-bold text-blue-600",children:s.quantity}),e.jsx("p",{className:"text-sm sm:text-base text-blue-500 font-medium",children:"Units"})]})]}),f&&e.jsxs("div",{className:"mb-6 p-3 sm:p-4 bg-red-50 border-l-4 border-red-300 rounded-lg flex items-start gap-3",children:[e.jsx(g,{className:"w-4 sm:w-5 h-4 sm:h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm sm:text-base text-red-900",children:"Error"}),e.jsx("p",{className:"text-xs sm:text-sm text-red-700",children:f})]})]}),m&&e.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-start gap-3 border-l-4 ${m.type==="success"?"bg-green-50 border-green-300":"bg-red-50 border-red-300"}`,children:[m.type==="success"?e.jsx($,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(g,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:`font-medium ${m.type==="success"?"text-green-800":"text-red-800"}`,children:m.message})]}),e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2 sm:mb-3 uppercase tracking-wide",children:"Quantity to Adjust"}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>d(Math.max(1,t-1)),disabled:t<=1||n,className:`flex-shrink-0 h-10 sm:h-12 w-10 sm:w-12 flex items-center justify-center text-gray-600 hover:text-gray-900 font-bold text-lg sm:text-xl transition-colors disabled:opacity-30 \r
                  bg-gray-100 disabled:cursor-not-allowed hover:bg-gray-100 rounded-lg`,children:"âˆ’"}),e.jsx(E,{type:"number",min:"1",value:t,onChange:a=>d(Math.max(1,parseInt(a.target.value)||1)),placeholder:"Qty",className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 text-center text-sm sm:text-lg font-bold border-2 border-blue-200 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-all bg-white"}),e.jsx("button",{onClick:()=>d(t+1),disabled:n,className:`flex-shrink-0 h-10 sm:h-12 w-10 sm:w-12 flex items-center justify-center text-gray-600 hover:text-gray-900 font-bold text-lg sm:text-xl transition-colors disabled:opacity-30 disabled:cursor-not-allowed \r
                  bg-gray-100 hover:bg-gray-200 rounded-lg`,children:"+"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4 mb-6",children:[e.jsx(u,{onClick:F,disabled:n,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 sm:py-4 text-xs sm:text-base rounded-lg shadow-sm hover:shadow-md transition-all flex items-center justify-center gap-1 sm:gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 sm:w-5 h-4 sm:h-5 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Adding"})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 sm:w-5 h-4 sm:h-5"}),e.jsx("span",{className:"sm:hidden inline",children:"Add Item"}),e.jsx("span",{className:"sm:inline",children:"Add"})]})}),e.jsx(u,{onClick:z,disabled:n,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 sm:py-4 text-xs sm:text-base rounded-lg shadow-sm hover:shadow-md transition-all flex items-center justify-center gap-1 sm:gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 sm:w-5 h-4 sm:h-5 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Deducting"})]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 sm:w-5 h-4 sm:h-5"}),e.jsx("span",{className:"sm:hidden inline",children:"Remove Item"}),e.jsx("span",{className:"sm:inline",children:"Remove"})]})})]}),e.jsx("div",{className:"p-3 sm:p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-xs sm:text-sm text-gray-700 text-center",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," Enter the quantity and click the appropriate button to update your inventory."]})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"mb-4",children:e.jsx(g,{className:"w-16 h-16 text-red-500 mx-auto"})}),e.jsx("h1",{className:"text-3xl font-bold mb-2 text-gray-900",children:"Item Not Found"}),e.jsxs("p",{className:"text-gray-600 mb-8",children:['The item "',e.jsx("strong",{children:decodeURIComponent(c||"")}),'" could not be found in your inventory.']}),e.jsxs(u,{onClick:()=>p("/inventory/view"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Back to View"]})]})}):e.jsx(B,{})};export{K as ItemDetail,K as default};
